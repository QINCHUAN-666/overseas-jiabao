<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>价保周期判定工具</title>
<style>
body {font-family:"Helvetica Neue",Arial,sans-serif;background:#f8f9fa;color:#333;margin:0;padding:0;}
header {
  display: flex;
  justify-content: space-between;
  align-items: flex-end; 
  padding: 28px 20px 16px;
  background: linear-gradient(to bottom, #ffffff, #f7f9fb);
  border-bottom: none; 
  box-shadow: 0 1px 4px rgba(0,0,0,0.05);
  
  max-width: 1500px; 
  margin: 0 auto;    
}

h1 {
  margin: 0;
  font-weight: 400;
  font-size: 1.4rem;
  color: #333;
}

.lang-switch select {
  padding: 6px 12px;
  font-size: 0.95em;
  border: 1px solid #ccc;
  border-radius: 6px;
  background: transparent;
  color: #333;
  outline: none;
  transition: border-color 0.2s;
}
.lang-switch select:hover {
  border-color: #007bff;
}


input[type="date"] {
    box-sizing: border-box;  
    padding: 10px;          
}

/* 标签页样式升级版 */
.tab-container {
  display: flex;
  gap: 8px;
  margin-top: 12px;
}

.tab {
  padding: 8px 18px;
  cursor: pointer;
  border-radius: 18px;
  background: transparent;
  border: 1px solid #ccc;
  color: #555;
  transition: all 0.2s ease;
}

.tab:hover {
  border-color: #007bff;
  color: #007bff;
}

.tab.active {
  background: #007bff;
  border-color: #007bff;
  color: #fff;
}
main {max-width:1500px;margin:30px auto;padding:20px;background:white;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.05);}
.form-group {margin-bottom:20px;}
label {display:block;margin-bottom:8px;font-weight:500;}
input,select,button {width:100%;padding:10px;font-size:1em;border:1px solid #ccc;border-radius:6px;}
button {background:#007bff;color:white;border:none;cursor:pointer;}
button:hover {background:#0056b3;}
#result {margin-top:30px;}
#result > div {background:#f1f3f5;padding:15px;margin-bottom:10px;border-radius:6px;}
.hidden {display:none;}
</style>
</head>
<body>
<header>
  <div>
<div class="tab-container">
  <div class="tab top-tab active" data-tab="main" id="tab-main">价保方案</div>
  <div class="tab top-tab" data-tab="special" id="tab-special">特殊场景</div>
</div>
  </div>
<div class="lang-switch" style="display:flex;flex-direction:column;align-items:flex-end;">
  <div style="font-size:0.85em;color:#555;margin-bottom:6px;">请选择语言/Please select language：</div>
  <div style="display:flex;gap:8px;">
<button id="btn-zh"
  style="padding:6px 12px;border:1px solid #ccc;border-radius:6px;background:#fff;cursor:pointer;color:#333;">
  中文
</button>
<button id="btn-en"
  style="padding:6px 12px;border:1px solid #ccc;border-radius:6px;background:#fff;cursor:pointer;color:#333;">
  English
</button>
  </div>
</div>
</header>

<main>
  <!-- 主功能 -->
<!-- 二级子标签，仅英文模式显示 -->

  <div id="main-content">

<div id="en-subtabs" class="tab-container hidden" style="margin-bottom:12px;">
  <div class="tab sub-tab active" data-subtab="other">Other products</div>
  <div class="tab sub-tab" data-subtab="romo">DJI Romo</div>
</div>


  <div id="other-products-form">
    <div class="form-group">
      <label for="country" id="label-country">国家/地区</label>
      <select id="country"></select>
    </div>
    
    <div class="form-group">
      <label for="channel" id="label-channel">购买渠道</label>
      <select id="channel"></select>
    </div>


<div id="link-display" style="margin-bottom:15px;"></div>

<div class="form-group">
  <label for="isActivityPeriod" id="label-isActivityPeriod">产品是否还在活动期</label>
  <select id="isActivityPeriod">
    <option id="option-yes" value="yes">在活动期内</option>
    <option id="option-no" value="no">活动已结束</option>
  </select>
</div>

    <div class="form-group">
      <label for="deliver-date" id="label-deliver-date">客户签收时间</label>
      <input type="date" id="deliver-date">
    </div>
    
    <div class="form-group">
      <label for="apply-date" id="label-apply-date">申请价保时间</label>
      <input type="date" id="apply-date">
    </div>


    <button id="calculate">判定价保周期</button>

    <section id="result" class="hidden">
      <h2 id="result-title">方案指引</h2>
      <div id="policy"></div>
      <div id="thought"></div>
      <div id="script"></div>
    </section>
  </div>


 <div id="romo-form" class="hidden">

<!-- 提示区域 -->
<div id="romo-tip" style="
    background-color:#fffbea;
    border:1px solid #ffe58f;
    padding:16px;
    border-radius:8px;
    margin-bottom:20px;
    font-family:Arial, 'Microsoft YaHei';
    color:#664d03;
    box-shadow:0 2px 6px rgba(0,0,0,0.05);
">
  <div style="display:flex;align-items:flex-start;gap:10px;">
    <div style="
        background-color:#faad14;
        color:white;
        font-weight:bold;
        border-radius:50%;
        width:28px;
        height:28px;
        display:flex;
        align-items:center;
        justify-content:center;
        font-size:16px;
    ">ℹ</div>
    <div style="flex:1;">
      <strong style="font-size:1.05em;">DJI Romo Price protection rules reminder</strong>
      <p style="margin:6px 0 4px;">We can provide price difference for all Orders which <strong>paid from 10.28 to 11.12</strong>, if customer contact us <strong>within the promotional period</strong>.</p>
      <p style="margin:6px 0 4px;">Notes: If order includes gift <strong>ROMO Accessory Kit</strong>, we need to deduct the value of the gift from the price difference.</p>
      <p style="margin:6px 0 0;"><em>Price difference= Actual paid amount(DJI Credits included) - the promotional price - the value/price of the ROMO Accessory Kit</em></p>
    </div>
  </div>
</div>

    <div class="form-group">


      <label>Actual paid amount (DJI Credits included)</label>
<input type="number" id="actual-paid" step="0.01" value="0">
    </div>
    <div class="form-group">
      <label>Promotional Price</label>
<input type="number" id="promo-price" step="0.01" value="0">
    </div>
    <div class="form-group">
      <label>ROMO Accessory Kit Value</label>
<input type="number" id="romo-value" step="0.01" value="0">
    </div>
    <div class="form-group">
      <label>Purchase Channel</label>
      <select id="romo-channel">
        <option value="Online Official Store">Online Official Store</option>
        <option value="Other Channels">Other Channels</option>
      </select>
    </div>



<div class="form-group" id="romo-date-group">
  <label>Customer contact time</label>
  <input type="date" id="romo-contact-date">
</div>
    <button id="romo-calc">Calculate & Output Solution</button>

    <section id="romo-result" class="hidden">
      <h2>Solution Guidelines</h2>
      <div id="romo-policy"></div>
      <div id="romo-thought"></div>
      <div id="romo-script"></div>
    </section>
  </div>  
</div>


  <!-- 特殊场景 -->
  <div id="special-content" class="hidden">
    <div class="form-group">
      <label for="special-country" id="label-special-country">国家/地区</label>
      <select id="special-country"></select>
    </div>
    <div id="special-display">
      <!-- 特殊场景会根据语言/国家显示 -->
    </div>
  </div>
</main>

<script>
/* 配置结构：
   1. tabs: 多语言tab标题
   2. countries: 国家列表
   3. channels: 每国的购买渠道列表
   4. activity: 每国的活动时间
   5. rules: 每国周期阈值
   6. policies: 每国/渠道政策
   7. specialCases: 特殊场景不同国家的文案/说明
*/
window.priceProtectConfig = {
  zh: {
    tabs: { main: "价保方案", special: "其他场景FAQ" },
    countries: ["中国港澳台","日本、韩国"],
    channels: {
      "中国港澳台": ["线上官方商城", "其他渠道"],
      "日本、韩国": ["线上官方商城", "其他渠道"],
    },
    activity: {
      "中国港澳台": { start: "2025-11-01", end: "2025-11-30" },
    },
    rules: {
      "中国港澳台": { thresholds: [7, 30] },
      "日本、韩国": { thresholds: [14, 30] },
    },

    links: {
      "中国港澳台": "https://docs.djicorp.com/weboffice/l/shYEp8S5foirW?linkname=11",
      "日本、韩国": "https://docs.djicorp.com/weboffice/l/shYEp8S5foirW?linkname=11",
    },


    labels: { 
      country: "国家/地区",
      channel: "购买渠道",
      isActivityPeriod: "产品是否还在活动期",
      isActivityYes: "在活动期内",
      isActivityNo: "活动已结束",
      deliverDate: "客户签收时间 (当地时间)",
      applyDate: "申请价保时间  (当地时间)",
      calcBtn: "判定价保周期",
      resultTitle: "方案指引",
      linkTable: "📄 各产品降价活动对照表",
      linkDesc: "包含产品名称、活动起止时间、降价幅度，价保金额",
      copyBtn: "📋 点击复制，并在浏览器访问",
      copied: "✔ 已复制"
  },


    policies: {
      "线上官方商城": {
within7: { 
  policy: "补 DJI币 or 退现金差价", 
  thought: `
    <div style="font-family:Arial, 'Microsoft YaHei'; line-height:1.6;">
      <strong style="color:#0066cc; font-size:1.1em;">方案二选一：</strong>
      <ol style="margin:8px 0 12px 20px; padding:0;">
        <li style="background-color:#fff3cd; padding:2px 4px; border-radius:4px;">
          提供差价对应的 <strong>DJI币</strong>
        </li>
        <li style="background-color:#d4edda; padding:2px 4px; border-radius:4px;">
          创建 CRM 案例安排仅退款退差价（<strong>现金</strong>）
        </li>
      </ol>
    </div>
  `,
  script: `

      <strong style="color:#0066cc; font-size:1.1em;">参考话术：</strong>
<div style="font-family:Arial, 'Microsoft YaHei'; line-height:1.6;">
  <p>
    尊敬的 <span style="background-color:#fff3cd;">XXX</span>，感谢您的信任，请您放心！<br>
    我们可以为您提供 <strong style="color:#17a2b8;">差价等值的 DJI币</strong> 或
    <strong style="color:#ffc107;">现金退差</strong>。<br>
    请问您倾向于 <span style="background-color:#fff3cd;">DJI币</span> 还是
    <span style="background-color:#d4edda;">现金退差</span> 呢？
  </p>

  <p style="margin:6px 0;">
    <strong>补偿DJI币：</strong> DJI币可用于购买 DJI 官方商城的任意商品（不含运费），DJI币将在订单收货后约 15 天生效。您可以届时访问  
    <a href="https://my.dji.com/credit" target="_blank" style="color:#0066cc;">查看您的DJI币余额</a> 。
  </p>

  <p style="margin:6px 0;">
    <strong>现金退差说明：</strong> 差价会在 2-7 个工作日原路退回至您的支付账户。
  </p>

  <p style="color:#6c757d; font-size:0.9em;">
    注：如后续发生退货，退货退款时将会扣除 DJI币补偿或差价部分。
  </p>
</div>
  `
},
within30: { 
  policy: "① 婉拒<br>② 灰度补偿DJI币<br>③退货重拍",   

  thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#dc3545;">1. 婉拒客户诉求</strong><br>
  参考话术：尊敬的 <span style="background-color:#fff3cd;">XXX</span>，如果您在DJI 官方商城购买的商品，自订单签收之日起7个自然日内降价，我们将向您提供差价补偿。
  由于您的订单已付款超过7天，因此不在补偿政策范围内。<span style="color:#dc3545;">很抱歉给您带来不便，感谢您的理解。</span></p>

  <p><strong style="color:#28a745;">2. 客户不接受，可参考降价明细提供对应补偿：</strong><br>
  <a href="https://docs.djicorp.com/weboffice/l/shYEp8S5foirW?linkname=1" target="_blank">https://docs.djicorp.com/weboffice/l/shYEp8S5foirW?linkname=1</a>

<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/776daa3ca0fc4e1582a9042dfce88d34.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
  参考话术：非常理解您的期望，为了感谢您对我们的支持，这边<strong style="color:#17a2b8;">特殊为您申请了XXX DJI币</strong>。DJI币可用于购买DJI 官方商城的任意商品（不含运费），DJI币将在订单收货后约15天生效，请访问
  <a href="https://my.dji.com/credit" target="_blank">查看您的DJI积分余额</a>，感谢您的理解~<br>
  <span style="color:#6c757d;">注：如后续发生退货，退货退款时将会扣除DJI币补偿部分</span></p>

  <p><strong style="color:#ffc107;">3. 如客户不接受DJI币，客户可退货重拍（需符合退货政策）</strong><br>
  参考话术：同为消费者非常理解您的心情，如您的产品符合店铺退货要求，您这边可以申请退货退款，再重新以活动价购买，您看看这样可以吗？的确是麻烦您了~</p>

  <p><strong style="color:#6c757d;">4. 如客户不接受DJI币及退货，无其他补充方案</strong><br>
  参考话术：非常抱歉没有达到您的预期。的确是您的订单已超过了店铺的价保周期，不支持提供对应的差价补偿，还请您理解呢。<br>
  活动是不定期举行的，我们也非常希望您能以优惠的价格购买到商品，的确目前您的订单因超过价保时效，无法再进行价保，我已尽最大努力为您争取到了XXX DJI 币，还请您再考虑下。</p>
</div>
  `,

  script: `
<strong>若客户不接受相关方案或政策解释：</strong><br><br>
【处理原则】<br>
1. 如遇到明确表示恶意霸线场景（霸线 ≥15 分钟），按如下思路和沟通节奏处理，然后走礼貌挂机流程（需报备TL审批，TL审批后登记至：
<a href="https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1" target="_blank">https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1</a>）。<br>
2. 升级客诉规范：<br>
① 无风险场景尽量拦截，按照话术及方案澄清价保原则，告知有方案/无方案，不升级客诉。<br>
② 如遇如下场景，可升级客诉处理（注：搜集客户姓名、电话、及客户信息升级客诉；客诉标签选择：电商-活动争议）。<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
【参考话术】<br>
<strong>第一次沟通：</strong>您的心情我完全理解，确实超出活动价保周期的情况会让您感到难受，但也帮您核查到由于您的订单已超过价保政策时间，很抱歉无法满足您的需求，辛苦您谅解。<br><br>
<strong>第二次主导沟通：</strong>非常理解您的心情，这边看到您的订单时间是<span style="background-color:#fff3cd;">XX</span>。您提前购买了产品，也能记录更多独一无二的精彩时刻。但这个订单已经超出活动价保时效了，抱歉确实无法为您提供价保服务。<br><br>
<strong>第三次礼貌挂机：</strong>我们非常希望能协助您解决问题，但目前您的订单因超过价保时效，无法再进行价保，我已尽最大努力为您争取到了<span style="background-color:#d4edda;">XXX DJI 币</span>，衷心希望您可以理解。如果您后续还有其他问题，欢迎您随时联系我们。先不打扰您了，祝您生活愉快，再见。
  `
},
over30: { 
  policy: "无补发方案，婉拒需求，无任何灰度方案。如客户不接受，充分解释政策，根据沟通情况礼貌挂机。如有风险场景及时升级",  

  thought: `
  <p><strong style="color:#6c757d;">参考话术：</strong><br>
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#dc3545;">1.</strong> 尊敬的 <span style="background-color:#fff3cd;">XXX</span>，如果您在DJI 官方商城购买的商品，自订单签收之日起7个自然日内降价，我们将向您提供差价补偿。由于您的订单已付款超过7天，因此不在补偿政策范围内。<span style="color:#dc3545;">很抱歉给您带来不便，感谢您的理解。</span></p>

  <p><strong style="color:#dc3545;">2.</strong> 非常抱歉没有达到您的预期。的确是您的订单已超过了店铺的价保周期，不支持提供对应的差价补偿，还请您理解呢。</p>

  <p><strong style="color:#dc3545;">3.</strong> 活动是不定期举行的，我们也非常希望您能以优惠的价格购买到商品，的确目前您的订单因超过价保时效，无法再进行价保，衷心希望您可以理解。</p>
</div>
  `,

  script: `
<strong>若客户不接受相关方案或政策解释：</strong><br><br>
【处理原则】<br>
1. 如遇到明确表示恶意霸线场景（霸线 ≥15 分钟），按如下思路和沟通节奏处理，然后走礼貌挂机流程（需报备TL审批，TL审批后登记至：
<a href="https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1" target="_blank">https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1</a>）。<br>
2. 升级客诉规范：<br>
① 无风险场景尽量拦截，按照话术及方案澄清价保原则，告知有方案/无方案，不升级客诉。<br>
② 如遇如下场景，可升级客诉处理（注：搜集客户姓名、电话、及客户信息升级客诉；客诉标签选择：电商-活动争议）。<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
【参考话术】<br>
<strong>第一次沟通：</strong><span style="background-color:#fff3cd;">XX先生/女士</span>，您的心情我完全理解，确实超出活动价保周期的情况会让您感到难受，但也帮您核查到由于您的订单已超过价保政策时间太久，所以也遗憾无法为您提供价保服务或退差价，辛苦您谅解。<br><br>

<strong>第二次主导沟通：</strong>非常理解您的心情，这边看到您的订单时间是<span style="background-color:#fff3cd;">XX</span>。您提前购买了产品，也能记录更多独一无二的精彩时刻。但这个订单已经超出活动价保时效很长时间了，抱歉确实无法为您提供价保服务或退差价。<br><br>

<strong>第三次礼貌挂机：</strong>我们非常希望能协助您解决问题，但目前您的订单因超过价保时效很久，无法再进行价保，衷心希望您可以理解。如果您后续还有其他问题，欢迎您随时联系我们。先不打扰您了，祝您生活愉快，再见。
  `
},
afterActivity: { 
  policy: "若客户要求价保，婉拒需求，有风险的升级客诉",  

  thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#dc3545;">婉拒话术1：</strong><br>
  您好，非常感谢您对我们产品的支持，了解到您描述的价保问题，由于<strong>活动已经结束</strong>，目前商品价格未发生变化，是不支持价保的呢，还请您谅解。</p>

  <p><strong style="color:#dc3545;">婉拒话术2：</strong><br>
  活动已经结束，这次确实无法为您提供价保补偿，但您购买的产品我们依然会持续为您提供其他优质的服务和保障，希望能够得到您的理解。
  如果您在使用产品过程中有任何问题，欢迎随时联系我们，我们会竭诚为您解决。</p>
</div>
  `,

  script: `
<strong>如遇如下场景，可升级客诉处理</strong><br>
<span style="color:#6c757d; font-size:0.9em;">注：搜集客户姓名、电话、及客户信息升级客诉；客诉标签选择：电商-活动争议。</span>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
  `
}
      },
      "其他渠道": {
  within7: { 
    policy: "无价保（仅内部知悉） 引导客户与购买方沟通确认",  

    thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#6c757d;">说明：</strong> 不同渠道的价保、补偿、优惠等可能有差异，需要客户联系对应卖家沟通确认。</p>
  <p><strong style="color:#0066cc;">参考话术：</strong><br>
    您好，查询到您的产品不是从线上官方商城购买，为了确保您能享受到最佳的售后服务和保障，我们建议您先联系卖家进行咨询和处理。感谢您的理解。
  </p>
</div>
    `,

    script: `
<strong>若客户不接受相关方案或政策解释：</strong><br><br>

<strong>【处理思路】</strong><br>
不同渠道活动方案可能有差异，需要引导客户联系卖家沟通解决。<br>
针对降价 & 价保问题，若客户投诉代理商（如服务态度、服务质量等），请搜集相关信息，在GT专群【手持海外活动线上线下联动】反馈代理商接口人。<br><br>

<strong>搜集信息模板：</strong><br>
【代理商】：<br>
【客户购买产品型号】：<br>
【产品SN】：<br>
【姓名】：<br>
【联系方式】：电话/邮箱<br>
【购买凭证】：<br><br>

<strong>【非官方商城价保问题 处理原则】</strong><br>
1. 如遇到明确表示恶意霸线场景（霸线 ≥15 分钟），按如下思路和沟通节奏处理，然后走礼貌挂机流程（需报备TL审批，TL审批后登记至：
<a href="https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1" target="_blank">https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1</a>）。<br>
2. 升级客诉规范：<br>
① 无风险场景尽量拦截，按照话术及方案澄清价保原则，告知有方案/无方案，不升级客诉。<br>
② 如遇如下场景，可升级客诉处理（注：搜集客户姓名、电话、及客户信息升级客诉；客诉标签选择：电商-活动争议）。<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong>【参考话术】</strong><br>
<strong>第一次沟通：</strong>XX先生/女士，抱歉给您带来不好的体验，这边看到您不是从线上官方渠道购买的产品，不同渠道在活动方案上（价保、优惠等）可能会有一些差异，具体还是得麻烦您和卖家进行沟通。<br><br>
<strong>第二次主导沟通：</strong>您可以先联系卖家，请工作人员结合实际情况和您沟通。我们也是希望您咨询的问题能得到尽快处理，所以建议您和卖家直接联系，这样能尽量节省您的时间。<br><br>
<strong>第三次礼貌挂机：</strong>明白您的诉求，我们也非常希望能协助您。但非官方渠道购买的产品，我们确实无法为您处理价保需求。还是麻烦您和卖家直接联系。如果您后续还有其他问题，欢迎您随时联系我们。先不打扰您了，祝您生活愉快，再见。
    `
  },
        within30: {     policy: "无价保（仅内部知悉） 引导客户与购买方沟通确认",  

    thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#6c757d;">说明：</strong> 不同渠道的价保、补偿、优惠等可能有差异，需要客户联系对应卖家沟通确认。</p>
  <p><strong style="color:#0066cc;">参考话术：</strong><br>
    您好，查询到您的产品不是从线上官方商城购买，为了确保您能享受到最佳的售后服务和保障，我们建议您先联系卖家进行咨询和处理。感谢您的理解。
  </p>
</div>
    `,

    script: `
<strong>若客户不接受相关方案或政策解释：</strong><br><br>

<strong>【处理思路】</strong><br>
不同渠道活动方案可能有差异，需要引导客户联系卖家沟通解决。<br>
针对降价 & 价保问题，若客户投诉代理商（如服务态度、服务质量等），请搜集相关信息，在GT专群【手持海外活动线上线下联动】反馈代理商接口人。<br><br>

<strong>搜集信息模板：</strong><br>
【代理商】：<br>
【客户购买产品型号】：<br>
【产品SN】：<br>
【姓名】：<br>
【联系方式】：电话/邮箱<br>
【购买凭证】：<br><br>

<strong>【非官方商城价保问题 处理原则】</strong><br>
1. 如遇到明确表示恶意霸线场景（霸线 ≥15 分钟），按如下思路和沟通节奏处理，然后走礼貌挂机流程（需报备TL审批，TL审批后登记至：
<a href="https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1" target="_blank">https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1</a>）。<br>
2. 升级客诉规范：<br>
① 无风险场景尽量拦截，按照话术及方案澄清价保原则，告知有方案/无方案，不升级客诉。<br>
② 如遇如下场景，可升级客诉处理（注：搜集客户姓名、电话、及客户信息升级客诉；客诉标签选择：电商-活动争议）。<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong>【参考话术】</strong><br>
<strong>第一次沟通：</strong>XX先生/女士，抱歉给您带来不好的体验，这边看到您不是从线上官方渠道购买的产品，不同渠道在活动方案上（价保、优惠等）可能会有一些差异，具体还是得麻烦您和卖家进行沟通。<br><br>
<strong>第二次主导沟通：</strong>您可以先联系卖家，请工作人员结合实际情况和您沟通。我们也是希望您咨询的问题能得到尽快处理，所以建议您和卖家直接联系，这样能尽量节省您的时间。<br><br>
<strong>第三次礼貌挂机：</strong>明白您的诉求，我们也非常希望能协助您。但非官方渠道购买的产品，我们确实无法为您处理价保需求。还是麻烦您和卖家直接联系。如果您后续还有其他问题，欢迎您随时联系我们。先不打扰您了，祝您生活愉快，再见。
    ` },
        over30: {     policy: "无价保（仅内部知悉） 引导客户与购买方沟通确认",  

    thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#6c757d;">说明：</strong> 不同渠道的价保、补偿、优惠等可能有差异，需要客户联系对应卖家沟通确认。</p>
  <p><strong style="color:#0066cc;">参考话术：</strong><br>
    您好，查询到您的产品不是从线上官方商城购买，为了确保您能享受到最佳的售后服务和保障，我们建议您先联系卖家进行咨询和处理。感谢您的理解。
  </p>
</div>
    `,

    script: `
<strong>若客户不接受相关方案或政策解释：</strong><br><br>

<strong>【处理思路】</strong><br>
不同渠道活动方案可能有差异，需要引导客户联系卖家沟通解决。<br>
针对降价 & 价保问题，若客户投诉代理商（如服务态度、服务质量等），请搜集相关信息，在GT专群【手持海外活动线上线下联动】反馈代理商接口人。<br><br>

<strong>搜集信息模板：</strong><br>
【代理商】：<br>
【客户购买产品型号】：<br>
【产品SN】：<br>
【姓名】：<br>
【联系方式】：电话/邮箱<br>
【购买凭证】：<br><br>

<strong>【非官方商城价保问题 处理原则】</strong><br>
1. 如遇到明确表示恶意霸线场景（霸线 ≥15 分钟），按如下思路和沟通节奏处理，然后走礼貌挂机流程（需报备TL审批，TL审批后登记至：
<a href="https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1" target="_blank">https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1</a>）。<br>
2. 升级客诉规范：<br>
① 无风险场景尽量拦截，按照话术及方案澄清价保原则，告知有方案/无方案，不升级客诉。<br>
② 如遇如下场景，可升级客诉处理（注：搜集客户姓名、电话、及客户信息升级客诉；客诉标签选择：电商-活动争议）。<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong>【参考话术】</strong><br>
<strong>第一次沟通：</strong>XX先生/女士，抱歉给您带来不好的体验，这边看到您不是从线上官方渠道购买的产品，不同渠道在活动方案上（价保、优惠等）可能会有一些差异，具体还是得麻烦您和卖家进行沟通。<br><br>
<strong>第二次主导沟通：</strong>您可以先联系卖家，请工作人员结合实际情况和您沟通。我们也是希望您咨询的问题能得到尽快处理，所以建议您和卖家直接联系，这样能尽量节省您的时间。<br><br>
<strong>第三次礼貌挂机：</strong>明白您的诉求，我们也非常希望能协助您。但非官方渠道购买的产品，我们确实无法为您处理价保需求。还是麻烦您和卖家直接联系。如果您后续还有其他问题，欢迎您随时联系我们。先不打扰您了，祝您生活愉快，再见。
    ` },
        afterActivity:{     policy: "无价保（仅内部知悉） 引导客户与购买方沟通确认",  

    thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#6c757d;">说明：</strong> 不同渠道的价保、补偿、优惠等可能有差异，需要客户联系对应卖家沟通确认。</p>
  <p><strong style="color:#0066cc;">参考话术：</strong><br>
    您好，查询到您的产品不是从线上官方商城购买，为了确保您能享受到最佳的售后服务和保障，我们建议您先联系卖家进行咨询和处理。感谢您的理解。
  </p>
</div>
    `,

    script: `
<strong>若客户不接受相关方案或政策解释：</strong><br><br>

<strong>【处理思路】</strong><br>
不同渠道活动方案可能有差异，需要引导客户联系卖家沟通解决。<br>
针对降价 & 价保问题，若客户投诉代理商（如服务态度、服务质量等），请搜集相关信息，在GT专群【手持海外活动线上线下联动】反馈代理商接口人。<br><br>

<strong>搜集信息模板：</strong><br>
【代理商】：<br>
【客户购买产品型号】：<br>
【产品SN】：<br>
【姓名】：<br>
【联系方式】：电话/邮箱<br>
【购买凭证】：<br><br>

<strong>【非官方商城价保问题 处理原则】</strong><br>
1. 如遇到明确表示恶意霸线场景（霸线 ≥15 分钟），按如下思路和沟通节奏处理，然后走礼貌挂机流程（需报备TL审批，TL审批后登记至：
<a href="https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1" target="_blank">https://docs.djicorp.com/weboffice/l/sd17qDgMfB0nA?linkname=1</a>）。<br>
2. 升级客诉规范：<br>
① 无风险场景尽量拦截，按照话术及方案澄清价保原则，告知有方案/无方案，不升级客诉。<br>
② 如遇如下场景，可升级客诉处理（注：搜集客户姓名、电话、及客户信息升级客诉；客诉标签选择：电商-活动争议）。<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong>【参考话术】</strong><br>
<strong>第一次沟通：</strong>XX先生/女士，抱歉给您带来不好的体验，这边看到您不是从线上官方渠道购买的产品，不同渠道在活动方案上（价保、优惠等）可能会有一些差异，具体还是得麻烦您和卖家进行沟通。<br><br>
<strong>第二次主导沟通：</strong>您可以先联系卖家，请工作人员结合实际情况和您沟通。我们也是希望您咨询的问题能得到尽快处理，所以建议您和卖家直接联系，这样能尽量节省您的时间。<br><br>
<strong>第三次礼貌挂机：</strong>明白您的诉求，我们也非常希望能协助您。但非官方渠道购买的产品，我们确实无法为您处理价保需求。还是麻烦您和卖家直接联系。如果您后续还有其他问题，欢迎您随时联系我们。先不打扰您了，祝您生活愉快，再见。
    ` }
      }
    },
specialCases: {
  "中国港澳台": { 
    title: "特殊场景说明 - 中国港澳台", 
    content: "",
    cases: [
      {
        title: "场景1：客户恶意语言中伤或辱骂",
        script: `
<span style="color:#d9534f; font-weight:bold;">参考话术1：</span>
X先生/女士，我们非常希望帮您解决问题，但鉴于您持续辱骂的不文明行为，我们已无法与您正常沟通，
为了不占用其他客户的等待时间，我将结束当前对话。
后续如果您希望沟通产品使用和技术咨询方面的问题，可以再次联系我们。感谢您的理解。`
      },
      {
        title: "场景2：赠品不支持价保",
        script: `<span style="color:#d9534f; font-weight:bold;">参考话术1：</span>
非常理解您的需求，在价保周期内，如因同一商品出现商家官方降价产生的差价，是支持价保的，
赠品不在价保范围内呢，还请您理解。

<span style="color:#d9534f; font-weight:bold;">参考话术2：</span>
理解您的心情，仅在活动期购买的订单才享受赠品，且赠品数量是有限的，
先到先得，无法申请补发，确实很抱歉。`
      }
    ]
  },
  "日本、韩国": {     title: "特殊场景说明 - 日本、韩国", 
    content: "",
    cases: [
      {
        title: "场景1：客户恶意语言中伤或辱骂",
        script: `
<span style="color:#d9534f; font-weight:bold;">参考话术1：</span>
X先生/女士，我们非常希望帮您解决问题，但鉴于您持续辱骂的不文明行为，我们已无法与您正常沟通，
为了不占用其他客户的等待时间，我将结束当前对话。
后续如果您希望沟通产品使用和技术咨询方面的问题，可以再次联系我们。感谢您的理解。`
      },
      {
        title: "场景2：赠品不支持价保",
        script: `<span style="color:#d9534f; font-weight:bold;">参考话术1：</span>
非常理解您的需求，在价保周期内，如因同一商品出现商家官方降价产生的差价，是支持价保的，
赠品不在价保范围内呢，还请您理解。

<span style="color:#d9534f; font-weight:bold;">参考话术2：</span>
理解您的心情，仅在活动期购买的订单才享受赠品，且赠品数量是有限的，
先到先得，无法申请补发，确实很抱歉。`
      }
    ]
  },
  "日本": { title:"特殊场景说明 - 日本", content:"这里是日本的特殊场景说明或政策" },
  "美国": { title:"特殊场景说明 - 美国", content:"这里是美国的特殊场景说明或政策" }
}
  },


  en: {
    tabs: { main: "Price Match", special: "Special Cases" },
    countries: ["Asia Pacific (Hong Kong)", "Europe", "Americas (US, Canada, Puerto Rico)", "Asia Pacific (Australia, New Zealand,Singapore,Philippines)"],
    channels: {
      "Asia Pacific (Hong Kong)": ["Online Official Store", "Other Channels"],
      "Europe": ["Online Official Store", "Other Channels"],
      "Americas (US, Canada, Puerto Rico)": ["Online Official Store", "Other Channels"],
      "Asia Pacific (Australia, New Zealand,Singapore,Philippines)": ["Online Official Store", "Other Channels"]
    },
    activity: {
      "Asia Pacific (Hong Kong)": { start: "2025-11-01", end: "2025-11-30" },
      "Europe": { start: "2025-11-01", end: "2025-11-30" },
      "Americas (US, Canada, Puerto Rico)": { start: "2025-11-01", end: "2025-11-30" },
      "Asia Pacific (Australia, New Zealand,Singapore,Philippines)": { start: "2025-11-01", end: "2025-11-30" }
    },
    rules: {
      "Asia Pacific (Hong Kong)": { thresholds: [7, 30] },
      "Europe": { thresholds: [14, 30] },
      "Americas (US, Canada, Puerto Rico)": { thresholds: [14, 30] },
      "Asia Pacific (Australia, New Zealand,Singapore,Philippines)": { thresholds: [14, 30] },
    },
    links: {
      "Asia Pacific (Hong Kong)": "https://docs.djicorp.com/weboffice/l/shYEp8S5foirW?linkname=11",
      "Europe": "https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO",
      "Americas (US, Canada, Puerto Rico)": "https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO",
      "Asia Pacific (Australia, New Zealand,Singapore,Philippines)": "https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO",
    },
    labels: { 
      country: "Country / Region",
      channel: "Purchase Channel",
      isActivityPeriod: "Is the product still within the promotion period?",
      isActivityYes: "Within promotion period",
      isActivityNo: "Promotion ended",
      deliverDate: "Customer Delivery Date (Local time)",
      applyDate: "Price Match Request Date (Local time)",
      calcBtn: "Check Price Match Period",
      resultTitle: "Solution Guidelines",
      linkTable: "📄 Product Price Drop & Promotion List",
      linkDesc: "Includes product name, promotion dates, discount amount, and price protection amount",
      copyBtn: "📋 Click to copy and open in browser",
      copied: "✔ Copied"
},
    policies: {
      "Online Official Store": {


    romo: {
        within7: {
            policy: "【DJI Romo】活动期内政策说明",
            thought: "Romo 专用补偿规则说明...",
            script: "Romo 专用参考话术..."
        },
        within30: {
            policy: "【DJI Romo】活动期内超过7天的政策说明",
            thought: "补偿原则...",
            script: "参考话术..."
        },
        over30: {
            policy: "【DJI Romo】活动期内超过30天的政策说明",
            thought: "处理原则...",
            script: "参考话术..."
        },
        afterActivity: {
            policy: "【DJI Romo】活动结束后政策说明",
            thought: "处理原则...",
            script: "参考话术..."
        }
    },




hk_within30: {
policy: "① Decline Politely<br>② Offer DJI Credit as compensation<br>③Offer Return and refund option",   

  thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#dc3545;">1. Politely decline the customer's request</strong><br>
<strong style="color:#0066cc; font-size:1.1em;">Reference Script:</strong>
<div style="font-family:Arial, 'Microsoft YaHei'; line-height:1.6;">
  <p>
    Dear <span style="background-color:#fff3cd;">XXX</span>, if any item you purchased from the DJI Official Store is reduced in price within 7 calendar days of delivery, we offer compensation for price difference. As your order is now beyond this 7-day window, it's no longer eligible for compensation.<span style="color:#dc3545;">We appreciate your understanding regarding this policy limitation.</span>
  </p>

  <p><strong style="color:#28a745;">2. If the customer does not accept, you may refer to the discount details to provide corresponding compensation: </strong><br>
  <a href="https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO" target="_blank">https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO</a>

<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/c08b6de39a254139a42f798d6a178b6c.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong style="color:#0066cc; font-size:1.1em;">Reference Script:</strong>
<div style="font-family:Arial, 'Microsoft YaHei'; line-height:1.6;">
  <p>
    We fully appreciate your expectations. As a gesture of gratitude for your support, we have <strong style="color:#17a2b8;">exceptionally granted you XXX DJI Credits</strong>.<br>
    DJI Credits can be used to purchase any product from the DJI Official Store (excluding shipping fees) and will become effective approximately 15 days after order delivery. Please visit 
    <a href="https://my.dji.com/credit" target="_blank">https://my.dji.com/credit</a> to check your DJI Credit balance.<br>
    Thank you for your understanding!
  </p>
  <p style="color:#6c757d; font-size:0.9em;">
    Note: If a return occurs later, the DJI Credit compensation will be deducted from your refund.
  </p>

  <p><strong style="color:#ffc107;">3. If the customer does not accept DJI Credit, the customer may return the product and place a new order (subject to the return policy).</strong><br>
Reference Script: I completely understand how you feel. If your product meets the requirements of our return policy, you can apply for a return and refund, and then repurchase the item at the promotional price. Would this solution work for you?</p>

  <p><strong style="color:#6c757d;">4. If the customer does not accept DJI Credit or a return, and there is no other additional solution</strong><br>
Reference Script: We sincerely apologize for not meeting your expectations. Indeed, your order has exceeded the DJI Online store's price match period and is not eligible for the corresponding price match policy. Thank you for your understanding.<br>
  The promotional event is held irregularly, and we also hope you can purchase products at a discounted price. Since your order has exceeded the price protection period, price protection can no longer be applied. I have already done my best to apply XXX DJI Credit for you. Please consider this.</p>
</div>
  `,

  script: `
<strong>If the customer does not accept the relevant solution or policy explanation</strong><br><br>
【Reply Template】<br>
<strong>First Communication: </strong>I completely understand how you feel, and it is indeed upsetting when the price protection period for a promotion has expired. However, after checking, your order has exceeded the price protection policy period. We are sorry we cannot fulfill your request and appreciate your understanding.<br><br>
<strong>Second Leading Communication: </strong>We completely understand how you feel. We see that your order was placed on XX. You purchased the product in advance, allowing you to capture more unique and remarkable moments. However, this order has already exceeded the price protection period for the promotion, so we are sorry that we cannot provide price protection service for you.
<br><br>
<strong>Third Polite Call Ending:</strong>We sincerely hope to assist you in resolving the issue. However, your order can no longer be price-protected as it has exceeded the price protection period. I have done my utmost to secure XXX DJI Credits for you, and I sincerely hope for your understanding. If you have any other questions in the future, please feel free to contact us at any time. I won't disturb you any further. Wish you a wonderful day. Goodbye.
  `
},



within7: { 
  policy: "Apply DJI Credit or Refund the price difference in cash", 
  thought: `
    <div style="font-family:Arial, 'Microsoft YaHei'; line-height:1.6;">
      <strong style="color:#0066cc; font-size:1.1em;">Two Options</strong>
      <ol style="margin:8px 0 12px 20px; padding:0;">
        <li style="background-color:#fff3cd; padding:2px 4px; border-radius:4px;">
           1. Provide DJI Credit for the price difference 
        </li>
        <li style="background-color:#d4edda; padding:2px 4px; border-radius:4px;">
          2. Provide Refund: Create a CRM case to arrange a refund for the price difference （<strong>cash</strong>）
        </li>
      </ol>
    </div>
  `,
  script: `

<strong style="color:#0066cc; font-size:1.1em;">Reference Script:</strong>
<div style="font-family:Arial, 'Microsoft YaHei'; line-height:1.6;">
  <p>
    Dear <span style="background-color:#fff3cd;">XXX</span>, thank you for your trust. Please rest assured!<br>
    We can offer you <strong style="color:#17a2b8;">DJI Credit equivalent to the price difference</strong> or
    <strong style="color:#ffc107;">a cash refund for the difference</strong>.<br>
    Would you prefer <span style="background-color:#fff3cd;">DJI Credit</span> or
    <span style="background-color:#d4edda;">a cash refund</span>?
  </p>
  <p style="margin:6px 0;">
    <strong>DJI Credit Compensation:</strong> DJI Credit can be used to purchase any product from the official DJI Store (excluding shipping fees). DJI Credit will become effective approximately 15 days after the order is delivered. You can check your DJI Credit balance at  
    <a href="https://my.dji.com/credit" target="_blank" style="color:#0066cc;">https://my.dji.com/credit</a>.
  </p>
  <p style="margin:6px 0;">
    <strong>Cash Refund for Price Difference:</strong> The price difference will be refunded to your original payment account within 2–7 business days.
  </p>
  <p style="color:#6c757d; font-size:0.9em;">
    Note: If a return occurs later, the DJI Credit compensation or price difference will be deducted from the refund amount.
  </p>
</div>
  `
},
within30: { 
  policy: "① Decline Politely<br>② Offer DJI Credit as compensation<br>③Offer Return and refund option",   

  thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#dc3545;">1. Politely decline the customer's request</strong><br>
<strong style="color:#0066cc; font-size:1.1em;">Reference Script:</strong>
<div style="font-family:Arial, 'Microsoft YaHei'; line-height:1.6;">
  <p>
    Dear <span style="background-color:#fff3cd;">XXX</span>, if any item you purchased from the DJI Official Store is reduced in price within 14 calendar days of delivery, we offer compensation for price difference. As your order is now beyond this 14-day window, it's no longer eligible for compensation.<span style="color:#dc3545;">We appreciate your understanding regarding this policy limitation.</span>
  </p>

  <p><strong style="color:#28a745;">2. If the customer does not accept, you may refer to the discount details to provide corresponding compensation: </strong><br>
  <a href="https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO" target="_blank">https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO</a>

<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/c08b6de39a254139a42f798d6a178b6c.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong style="color:#0066cc; font-size:1.1em;">Reference Script:</strong>
<div style="font-family:Arial, 'Microsoft YaHei'; line-height:1.6;">
  <p>
    We fully appreciate your expectations. As a gesture of gratitude for your support, we have <strong style="color:#17a2b8;">exceptionally granted you XXX DJI Credits</strong>.<br>
    DJI Credits can be used to purchase any product from the DJI Official Store (excluding shipping fees) and will become effective approximately 15 days after order delivery. Please visit 
    <a href="https://my.dji.com/credit" target="_blank">https://my.dji.com/credit</a> to check your DJI Credit balance.<br>
    Thank you for your understanding!
  </p>
  <p style="color:#6c757d; font-size:0.9em;">
    Note: If a return occurs later, the DJI Credit compensation will be deducted from your refund.
  </p>

  <p><strong style="color:#ffc107;">3. If the customer does not accept DJI Credit, the customer may return the product and place a new order (subject to the return policy).</strong><br>
Reference Script: I completely understand how you feel. If your product meets the requirements of our return policy, you can apply for a return and refund, and then repurchase the item at the promotional price. Would this solution work for you?</p>

  <p><strong style="color:#6c757d;">4. If the customer does not accept DJI Credit or a return, and there is no other additional solution</strong><br>
Reference Script: We sincerely apologize for not meeting your expectations. Indeed, your order has exceeded the DJI Online store's price match period and is not eligible for the corresponding price match policy. Thank you for your understanding.<br>
  The promotional event is held irregularly, and we also hope you can purchase products at a discounted price. Since your order has exceeded the price protection period, price protection can no longer be applied. I have already done my best to apply XXX DJI Credit for you. Please consider this.</p>
</div>
  `,

  script: `
<strong>If the customer does not accept the relevant solution or policy explanation</strong><br><br>
【Reply Template】<br>
<strong>First Communication: </strong>I completely understand how you feel, and it is indeed upsetting when the price protection period for a promotion has expired. However, after checking, your order has exceeded the price protection policy period. We are sorry we cannot fulfill your request and appreciate your understanding.<br><br>
<strong>Second Leading Communication: </strong>We completely understand how you feel. We see that your order was placed on XX. You purchased the product in advance, allowing you to capture more unique and remarkable moments. However, this order has already exceeded the price protection period for the promotion, so we are sorry that we cannot provide price protection service for you.
<br><br>
<strong>Third Polite Call Ending:</strong>We sincerely hope to assist you in resolving the issue. However, your order can no longer be price-protected as it has exceeded the price protection period. I have done my utmost to secure XXX DJI Credits for you, and I sincerely hope for your understanding. If you have any other questions in the future, please feel free to contact us at any time. I won't disturb you any further. Wish you a wonderful day. Goodbye.
  `
},
over30: { 
  policy: "No replacement solution. Decline the request; there is no gray-area solution available. If the customer does not accept, fully explain the policy and politely end the call based on the communication situation. If there are any risky scenarios, please upgrade promptly.",  

  thought: `
<p><strong style="color:#6c757d;">Reference Script:</strong><br>
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#dc3545;">1.</strong> Dear <span style="background-color:#fff3cd;">XXX</span>, per our price protection policy, we provide compensation for price differences if items purchased from the DJI Official Store drop in price within 14 calendar days of delivery. As your order falls outside this coverage period, we are unable to process compensation. We appreciate your understanding of these policy terms.</p>
  <p><strong style="color:#dc3545;">2.</strong> We regret that we could not meet your expectations on this occasion. Since your order exceeds our 14-day price protection window, we are unable to offer compensation for the price difference. We hope you can appreciate this policy consistency for all customers.</p>
  <p><strong style="color:#dc3545;">3.</strong> While promotional timing varies, we always aim to offer competitive pricing. As your order is now beyond the price protection period, we cannot apply retroactive adjustments. We truly value your understanding and hope to serve you better in the future.</p>
</div>
  `,

  script: `
<strong>If the customer does not accept the relevant solution or policy explanation</strong><br><br>
[Reply Template]<br>
<strong>First Communication: </strong><span style="background-color:#fff3cd;">Mr./Ms. XX</span>，I completely understand how you are feeling. It is indeed upsetting when the price protection period for promotions has passed. However, after checking for you, your order has exceeded the price protection policy period by too long a time. Regrettably, we are unable to provide price protection service or a refund for the difference. Thank you for your understanding.<br><br>

<strong>Second Leading Communication:</strong>We completely understand how you feel. We see that your order was placed on<span style="background-color:#fff3cd;">XX</span>。You purchased the product in advance, allowing you to capture more unique and remarkable moments. However, this order has exceeded the activity price protection validity period by a significant amount of time. We apologize, but we are unable to provide price protection service or a price difference refund.<br><br>

<strong>Third Courteous Hang-Up:</strong>We sincerely hope to assist you in resolving the issue, but as your order has exceeded the price protection period by a significant amount of time, we are unable to provide price protection. We truly hope for your understanding. If you have any other questions in the future, please feel free to contact us at any time. I won't disturb you any further. Wish you a wonderful day. Goodbye.
  `
},
afterActivity: { 
  policy: "If a customer requests price protection, politely refuse the request. If there is a risk, escalate to a customer complaint.",  

  thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#dc3545;">[Reply Template]:</strong><br>
    Hello, thank you very much for your support of our product. Regarding the price-protection issue you described, since <strong>the promotion has already ended</strong> and the product price has not changed, price protection is not available at this time. We appreciate your understanding.
  </p>
  
  <p><strong style="color:#dc3545;">[Reply Template]:</strong><br>
    The promotion has ended, so unfortunately we cannot provide price-protection compensation on this occasion. However, we will continue to provide you with other high-quality services and ongoing support for the product you purchased, and we hope for your understanding.  
    If you encounter any issues while using the product, please feel free to contact us at any time, and we will do our utmost to assist you.
  </p>
  
  <p>
    <strong>In the following scenarios, you can escalate the customer complaint</strong><br>
    <span style="color:#6c757d; font-size:0.9em;">
      Note: Collect the customer's name, phone number, and relevant information for complaint escalation; for complaint tags, select: E-commerce – Event Dispute.
    </span>
  </p>
</div>
  `,
  script: ``
}
      },


      "Other Channels": {



    romo: {
        within7: {
            policy: "【DJI Romo】活动期内政策说明",
            thought: "Romo 专用补偿规则说明...",
            script: "Romo 专用参考话术..."
        },
        within30: {
            policy: "【DJI Romo】活动期内超过7天的政策说明",
            thought: "补偿原则...",
            script: "参考话术..."
        },
        over30: {
            policy: "【DJI Romo】活动期内超过30天的政策说明",
            thought: "处理原则...",
            script: "参考话术..."
        },
        afterActivity: {
            policy: "【DJI Romo】活动结束后政策说明",
            thought: "处理原则...",
            script: "参考话术..."
        }
    },





        within7: {     policy: "No Protection Plan[Internal] Guide the customer to communicate and confirm with the purchaser.",  

    thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#6c757d;">explanation：</strong> There may be differences in price protection, compensation, discounts, etc. across different channels. The customer needs to contact the respective seller for communication and confirmation.</p>
  <p><strong style="color:#0066cc;">[Reply Template]：</strong><br>
    Hello, we have found that your product was not purchased through our official online store. To ensure you receive optimal after-sales support, we strongly recommend first contacting your point of purchase for assistance. We appreciate your understanding of this process.
  </p>
</div>
    `,

    script: `
<strong>If the customer does not accept the relevant solution or policy explanation</strong><br><br>

<strong>【Handling Principle】</strong><br>
Different promotional offers may vary by channel. Please advise the customer to contact the seller for further assistance.<br>
For price reduction & price protection issues, if a customer complains about dealers (such as service attitude, service quality, etc.), please gather relevant information and report it to the dealers' contact person in the GT dedicated group [手持海外活动线上线下联动].<br><br>

<strong>Information Collection Template:</strong><br>
[Dealers]:：<br>
[Customer Purchased Product Model]:<br>
[Product SN]:<br>
[Name]:<br>
[Contact Information]: Phone/Email<br>
[Proof of Purchase]:<br><br>

<strong>【nofficial Store Price Protection Issue Handling Principle】</strong><br>
1. In cases where a clear malicious line occupation Scenario is encountered (occupation of the line for 15 minutes or more), handle according to the following approach and communication pace, then proceed with the polite hang-up process (TL approval is required; after TL approval, record it at: 
<a href="https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO" target="_blank">https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO</a>）。<br>
2. Escalated Complaint Guidelines:<br>
① Intercept risk-free scenarios as much as possible, clarify the price protection policy according to the template and plan, inform whether there is a solution or not, and do not escalate the customer complaint.<br>
② In the following scenarios, you can escalate the customer complaint (Note: Collect the customer's name, phone number, and information for complaint escalation; for complaint tags, select: E-commerce - Event Dispute).<br><br>
<strong>【Reply Template】</strong><br>
<strong>First communication:</strong>Mr./Ms. XX, we apologize for the unpleasant experience. We see that the product was not purchased through the official online channel, and different channels may have some differences in promotional plans (such as price protection and discounts). For specific details, we kindly ask you to communicate directly with the seller.<br><br>
<strong>Second Communication Initiative: </strong>You may contact the seller first and have their staff discuss the situation with you based on the actual circumstances. We also hope your inquiry can be addressed as soon as possible, so we recommend that you contact the seller directly to help save your time.<br><br>
<strong>Third time politely ending the call: </strong>We understand your concerns and are very willing to assist you. However, for products purchased through unofficial channels, we are unable to process your price protection request. Please contact the seller directly. If you have any other questions in the future, please feel free to contact us at any time. I won't disturb you any further. Wish you a wonderful day. Goodbye.
    `
  },
        within30: {     policy: "No Protection Plan[Internal] Guide the customer to communicate and confirm with the purchaser.",  

    thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#6c757d;">explanation：</strong> There may be differences in price protection, compensation, discounts, etc. across different channels. The customer needs to contact the respective seller for communication and confirmation.</p>
  <p><strong style="color:#0066cc;">[Reply Template]：</strong><br>
    Hello, we have found that your product was not purchased through our official online store. To ensure you receive optimal after-sales support, we strongly recommend first contacting your point of purchase for assistance. We appreciate your understanding of this process.
  </p>
</div>
    `,

    script: `
<strong>If the customer does not accept the relevant solution or policy explanation</strong><br><br>

<strong>【Handling Principle】</strong><br>
Different promotional offers may vary by channel. Please advise the customer to contact the seller for further assistance.<br>
For price reduction & price protection issues, if a customer complains about dealers (such as service attitude, service quality, etc.), please gather relevant information and report it to the dealers' contact person in the GT dedicated group [手持海外活动线上线下联动].<br><br>

<strong>Information Collection Template:</strong><br>
[Dealers]:：<br>
[Customer Purchased Product Model]:<br>
[Product SN]:<br>
[Name]:<br>
[Contact Information]: Phone/Email<br>
[Proof of Purchase]:<br><br>

<strong>【nofficial Store Price Protection Issue Handling Principle】</strong><br>
1. In cases where a clear malicious line occupation Scenario is encountered (occupation of the line for 15 minutes or more), handle according to the following approach and communication pace, then proceed with the polite hang-up process (TL approval is required; after TL approval, record it at: 
<a href="https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO" target="_blank">https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO</a>）。<br>
2. Escalated Complaint Guidelines:<br>
① Intercept risk-free scenarios as much as possible, clarify the price protection policy according to the template and plan, inform whether there is a solution or not, and do not escalate the customer complaint.<br>
② In the following scenarios, you can escalate the customer complaint (Note: Collect the customer's name, phone number, and information for complaint escalation; for complaint tags, select: E-commerce - Event Dispute).<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong>【Reply Template】</strong><br>
<strong>First communication:</strong>Mr./Ms. XX, we apologize for the unpleasant experience. We see that the product was not purchased through the official online channel, and different channels may have some differences in promotional plans (such as price protection and discounts). For specific details, we kindly ask you to communicate directly with the seller.<br><br>
<strong>Second Communication Initiative: </strong>You may contact the seller first and have their staff discuss the situation with you based on the actual circumstances. We also hope your inquiry can be addressed as soon as possible, so we recommend that you contact the seller directly to help save your time.<br><br>
<strong>Third time politely ending the call: </strong>We understand your concerns and are very willing to assist you. However, for products purchased through unofficial channels, we are unable to process your price protection request. Please contact the seller directly. If you have any other questions in the future, please feel free to contact us at any time. I won't disturb you any further. Wish you a wonderful day. Goodbye.
    `
  },
        over30: {     policy: "No Protection Plan[Internal] Guide the customer to communicate and confirm with the purchaser.",  

    thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#6c757d;">explanation：</strong> There may be differences in price protection, compensation, discounts, etc. across different channels. The customer needs to contact the respective seller for communication and confirmation.</p>
  <p><strong style="color:#0066cc;">[Reply Template]：</strong><br>
    Hello, we have found that your product was not purchased through our official online store. To ensure you receive optimal after-sales support, we strongly recommend first contacting your point of purchase for assistance. We appreciate your understanding of this process.
  </p>
</div>
    `,

    script: `
<strong>If the customer does not accept the relevant solution or policy explanation</strong><br><br>

<strong>【Handling Principle】</strong><br>
Different promotional offers may vary by channel. Please advise the customer to contact the seller for further assistance.<br>
For price reduction & price protection issues, if a customer complains about dealers (such as service attitude, service quality, etc.), please gather relevant information and report it to the dealers' contact person in the GT dedicated group [手持海外活动线上线下联动].<br><br>

<strong>Information Collection Template:</strong><br>
[Dealers]:：<br>
[Customer Purchased Product Model]:<br>
[Product SN]:<br>
[Name]:<br>
[Contact Information]: Phone/Email<br>
[Proof of Purchase]:<br><br>

<strong>【nofficial Store Price Protection Issue Handling Principle】</strong><br>
1. In cases where a clear malicious line occupation Scenario is encountered (occupation of the line for 15 minutes or more), handle according to the following approach and communication pace, then proceed with the polite hang-up process (TL approval is required; after TL approval, record it at: 
<a href="https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO" target="_blank">https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO</a>）。<br>
2. Escalated Complaint Guidelines:<br>
① Intercept risk-free scenarios as much as possible, clarify the price protection policy according to the template and plan, inform whether there is a solution or not, and do not escalate the customer complaint.<br>
② In the following scenarios, you can escalate the customer complaint (Note: Collect the customer's name, phone number, and information for complaint escalation; for complaint tags, select: E-commerce - Event Dispute).<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong>【Reply Template】</strong><br>
<strong>First communication:</strong>Mr./Ms. XX, we apologize for the unpleasant experience. We see that the product was not purchased through the official online channel, and different channels may have some differences in promotional plans (such as price protection and discounts). For specific details, we kindly ask you to communicate directly with the seller.<br><br>
<strong>Second Communication Initiative: </strong>You may contact the seller first and have their staff discuss the situation with you based on the actual circumstances. We also hope your inquiry can be addressed as soon as possible, so we recommend that you contact the seller directly to help save your time.<br><br>
<strong>Third time politely ending the call: </strong>We understand your concerns and are very willing to assist you. However, for products purchased through unofficial channels, we are unable to process your price protection request. Please contact the seller directly. If you have any other questions in the future, please feel free to contact us at any time. I won't disturb you any further. Wish you a wonderful day. Goodbye.
    `
  },
        afterActivity:{     policy: "No Protection Plan[Internal] Guide the customer to communicate and confirm with the purchaser.",  

    thought: `
<div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;">
  <p><strong style="color:#6c757d;">explanation：</strong> There may be differences in price protection, compensation, discounts, etc. across different channels. The customer needs to contact the respective seller for communication and confirmation.</p>
  <p><strong style="color:#0066cc;">[Reply Template]：</strong><br>
    Hello, we have found that your product was not purchased through our official online store. To ensure you receive optimal after-sales support, we strongly recommend first contacting your point of purchase for assistance. We appreciate your understanding of this process.
  </p>
</div>
    `,

    script: `
<strong>If the customer does not accept the relevant solution or policy explanation</strong><br><br>

<strong>【Handling Principle】</strong><br>
Different promotional offers may vary by channel. Please advise the customer to contact the seller for further assistance.<br>
For price reduction & price protection issues, if a customer complains about dealers (such as service attitude, service quality, etc.), please gather relevant information and report it to the dealers' contact person in the GT dedicated group [手持海外活动线上线下联动].<br><br>

<strong>Information Collection Template:</strong><br>
[Dealers]:：<br>
[Customer Purchased Product Model]:<br>
[Product SN]:<br>
[Name]:<br>
[Contact Information]: Phone/Email<br>
[Proof of Purchase]:<br><br>

<strong>【nofficial Store Price Protection Issue Handling Principle】</strong><br>
1. In cases where a clear malicious line occupation Scenario is encountered (occupation of the line for 15 minutes or more), handle according to the following approach and communication pace, then proceed with the polite hang-up process (TL approval is required; after TL approval, record it at: 
<a href="https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO" target="_blank">https://docs.djicorp.com/weboffice/l/somxmt3FGGeBO</a>）。<br>
2. Escalated Complaint Guidelines:<br>
① Intercept risk-free scenarios as much as possible, clarify the price protection policy according to the template and plan, inform whether there is a solution or not, and do not escalate the customer complaint.<br>
② In the following scenarios, you can escalate the customer complaint (Note: Collect the customer's name, phone number, and information for complaint escalation; for complaint tags, select: E-commerce - Event Dispute).<br><br>
<div style=\"margin:0px 0;\"> <img src=\"https://terra-1-g.djicdn.com/eb222cbc4f4345e3a134199bab1f0894/63148291bb70458a8dc990c98ae51975.png\" alt=\"门店类型一图片\" style=\"max-width:100%;height:auto;\"</div>
<strong>【Reply Template】</strong><br>
<strong>First communication:</strong>Mr./Ms. XX, we apologize for the unpleasant experience. We see that the product was not purchased through the official online channel, and different channels may have some differences in promotional plans (such as price protection and discounts). For specific details, we kindly ask you to communicate directly with the seller.<br><br>
<strong>Second Communication Initiative: </strong>You may contact the seller first and have their staff discuss the situation with you based on the actual circumstances. We also hope your inquiry can be addressed as soon as possible, so we recommend that you contact the seller directly to help save your time.<br><br>
<strong>Third time politely ending the call: </strong>We understand your concerns and are very willing to assist you. However, for products purchased through unofficial channels, we are unable to process your price protection request. Please contact the seller directly. If you have any other questions in the future, please feel free to contact us at any time. I won't disturb you any further. Wish you a wonderful day. Goodbye.
    `
  }
      }
    },











    specialCases: {
      "Asia Pacific (Hong Kong)": {     title: "Other Scenario FAQs - Asia Pacific (Hong Kong)", 
    content: "",
    cases: [
      {
        title: "Scenario 1: If the customer uses malicious language to insult or verbally abuse, making normal communication impossible, please refer to the following template for politely ending the call.",
        script: `
<span style="color:#d9534f; font-weight:bold;">Reference template: </span>
Mr./Ms. [Name], while we remain committed to resolving your concern, the continued use of abusive language violates our service policy. To respect other customers' waiting time, we must now respectfully suspend this call. For further assistance when ready to communicate respectfully, please contact us again.`
      },
    ]
  },
      "Europe": {     title: "Other Scenario FAQs - Europe", 
    content: "",
    cases: [
      {
        title: "Scenario 1: If the customer uses malicious language to insult or verbally abuse, making normal communication impossible, please refer to the following template for politely ending the call.",
        script: `
<span style="color:#d9534f; font-weight:bold;">Reference template: </span>
Mr./Ms. [Name], while we remain committed to resolving your concern, the continued use of abusive language violates our service policy. To respect other customers' waiting time, we must now respectfully suspend this call. For further assistance when ready to communicate respectfully, please contact us again.`
      },
    ]
  },
      "Asia Pacific (Australia, New Zealand,Singapore,Philippines)": {     title: "Other Scenario FAQs - Asia Pacific (Australia, New Zealand,Singapore,Philippines)", 
    content: "",
    cases: [
      {
        title: "Scenario 1: If the customer uses malicious language to insult or verbally abuse, making normal communication impossible, please refer to the following template for politely ending the call.",
        script: `
<span style="color:#d9534f; font-weight:bold;">Reference template: </span>
Mr./Ms. [Name], while we remain committed to resolving your concern, the continued use of abusive language violates our service policy. To respect other customers' waiting time, we must now respectfully suspend this call. For further assistance when ready to communicate respectfully, please contact us again.`
      },
    ]
  },
      "Americas (US, Canada, Puerto Rico)": {     title: "Other Scenario FAQs - Americas (US, Canada, Puerto Rico)", 
    content: "",
    cases: [
      {
        title: "Scenario 1: If the customer uses malicious language to insult or verbally abuse, making normal communication impossible, please refer to the following template for politely ending the call.",
        script: `
<span style="color:#d9534f; font-weight:bold;">Reference template: </span>
Mr./Ms. [Name], while we remain committed to resolving your concern, the continued use of abusive language violates our service policy. To respect other customers' waiting time, we must now respectfully suspend this call. For further assistance when ready to communicate respectfully, please contact us again.`
      },
    ]
  }
    }
  }
};

document.addEventListener("DOMContentLoaded",()=>{
const btnZh=document.getElementById("btn-zh");
const btnEn=document.getElementById("btn-en");
  const countrySel=document.getElementById("country");
  const channelSel=document.getElementById("channel");
  const deliverDate=document.getElementById("deliver-date");
  const applyDate=document.getElementById("apply-date");
  const calcBtn=document.getElementById("calculate");
  const resSection=document.getElementById("result");
  const tabs=document.querySelectorAll(".tab");
  const mainContent=document.getElementById("main-content");
  const specialContent=document.getElementById("special-content");
  const specialCountrySel=document.getElementById("special-country");
  const specialDisplay=document.getElementById("special-display");
// 确保 ROMO 输入框默认是 0
document.getElementById("actual-paid").value = 0;
document.getElementById("promo-price").value = 0;
document.getElementById("romo-value").value = 0;
let lang="zh"; 



// 二级 Tab 切换（仅英语显示）
document.querySelectorAll('.sub-tab').forEach(st=>{
    st.addEventListener("click", () => {
        document.querySelectorAll('.sub-tab').forEach(t=>t.classList.remove("active"));
        st.classList.add("active");

        if (st.dataset.subtab === "other") {
            document.getElementById("other-products-form").classList.remove("hidden");
            document.getElementById("romo-form").classList.add("hidden");
        } else {
            document.getElementById("other-products-form").classList.add("hidden");
            document.getElementById("romo-form").classList.remove("hidden");
        }
    });
});


// 当渠道选择变化时，控制日期行显示/隐藏
document.getElementById("romo-channel").addEventListener("change", function () {
    const dateGroup = document.getElementById("romo-date-group");
    if (this.value === "Other Channels") {
        dateGroup.classList.add("hidden");
        document.getElementById("romo-contact-date").value = "";
    } else {
        dateGroup.classList.remove("hidden");
    }
});

document.getElementById("romo-calc").addEventListener("click", ()=>{
// 价格输入缺省值都按 0
const actual = parseFloat(document.getElementById("actual-paid").value) || 0;
const promo = parseFloat(document.getElementById("promo-price").value) || 0;
const romoVal = parseFloat(document.getElementById("romo-value").value) || 0;
    const channel = document.getElementById("romo-channel").value;
    const cfg = window.priceProtectConfig[lang];
    let outputPolicy = "", outputThought = "", outputScript = "";

    // 1️⃣ 如果是其他渠道 → 直接输出结论模板
    if (channel === "Other Channels") {
        const policyData = cfg.policies[channel].within7; // 直接用其他渠道模板
        outputPolicy  = policyData.policy || "";
        outputThought = policyData.thought || "";
        outputScript  = policyData.script || "";

    // 2️⃣ 如果是官方商城 → 判断日期区间
    } else {
        const contactVal = document.getElementById("romo-contact-date").value;
        if (!contactVal) {
            alert("Please select customer contact date");
            return;
        }
        const contactDate = new Date(contactVal);

        const startDate = new Date(contactDate.getFullYear(), 10, 13); 
        const endDate   = new Date(contactDate.getFullYear(), 11, 4); 

if (contactDate >= startDate && contactDate <= endDate) {
    const diff = actual - promo - romoVal;
    outputPolicy = `
    <div style="font-family:Arial,'Microsoft YaHei';line-height:1.6;margin-top:10px;">
      <p><strong>Price Difference:</strong> <span style="color:#d9534f;">${diff.toFixed(2)}</span></p>
      <table style="border-collapse:collapse;width:100%;background:#fff;">
        <thead>
          <tr style="background:#f2f2f2;">
            <th style="border:1px solid #ccc;padding:8px;text-align:left;width:30%;">Price Match Policy</th>
            <th style="border:1px solid #ccc;padding:8px;text-align:left;">Solution</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="border:1px solid #ccc;padding:8px;">Solution</td>
            <td style="border:1px solid #ccc;padding:8px;">[Reply Template]</td>
          </tr>
          <tr>
            <td style="border:1px solid #ccc;padding:8px;vertical-align:top;">
              Apply DJI Credit<br>or<br>Refund the price difference in cash<br><br>
              <strong>Two Options</strong><br>
              1. Provide DJI Credit for the price difference<br>
              2. Provide Refund: Create a CRM case to arrange a refund for the price difference (<strong>cash</strong>)<br><br>

            </td>
            <td style="border:1px solid #ccc;padding:8px;vertical-align:top;">

              Dear XXX, thank you for your trust. Please rest assured that we can offer you the price match in DJI Credit or a refund for the difference. Would you prefer DJI Credit or a cash refund for the difference?<br><br>
              <u>Compensation in DJI Credit:</u> DJI Credit can be used to purchase any product from the official DJI Store (excluding shipping fees). DJI Credit will become effective approximately 15 days after the order is delivered. You can check your DJI Credit balance at <a href="https://my.dji.com/credit" target="_blank" style="color:#007bff;">https://my.dji.com/credit</a> at that time.<br><br>
              <u>Cash Refund of Price Difference:</u> The price difference will be refunded to your original payment account within 2 to 7 business days.<br><br>
              <em>Note:</em> <br>1. If a return occurs later, the DJI Credit compensation or price difference will be deducted from the refund amount.<br>
              2. If the original order includes gift, the value of the gift will be subtracted from the price difference.
            </td>
          </tr>
          <tr>
            <td style="border:1px solid #ccc;padding:8px;vertical-align:top;">
              For the orders includes ROMO Accessory Kit, the value of the gift will be subtracted from the price difference. If customer ask why the price difference is lower than expected.
            </td>
            <td style="border:1px solid #ccc;padding:8px;vertical-align:top;">
              I understand your confusion regarding this matter. If the original order includes gift, its value will be deducted from the price difference. Since your order came with a <strong>ROMO Accessory Kit</strong>, that's why we need to deduct its value from the price difference. We really appreciate your understanding.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    `;
}else {
            // 不在活动期 → 拒绝价保
            const denyPolicy = cfg.policies[channel].afterActivity;
            outputPolicy  = denyPolicy.policy || "";
            outputThought = denyPolicy.thought || "";
            outputScript  = denyPolicy.script || "";
        }
    }

    // 输出结果到页面
    document.getElementById("romo-policy").innerHTML = outputPolicy;
    document.getElementById("romo-thought").innerHTML = outputThought;
    document.getElementById("romo-script").innerHTML = outputScript;
    document.getElementById("romo-result").classList.remove("hidden");
});

  const deliverGroup = deliverDate.parentElement;
  const applyGroup = applyDate.parentElement;
  const isActivitySel = document.getElementById("isActivityPeriod");


  isActivitySel.addEventListener("change", function () {
    if (this.value === "no") {

      deliverGroup.classList.add("hidden");
      applyGroup.classList.add("hidden");
      deliverDate.value = "";
      applyDate.value = "";


      const cfg = window.priceProtectConfig[lang];
      const country = countrySel.value;
      const channel = channelSel.value;
      const policy = cfg.policies[channel]["afterActivity"];

      document.getElementById("policy").innerHTML = policy.policy;
      document.getElementById("thought").innerHTML = policy.thought;
      document.getElementById("script").innerHTML = policy.script;
      resSection.classList.remove("hidden");
    } else {

      deliverGroup.classList.remove("hidden");
      applyGroup.classList.remove("hidden");
      resSection.classList.add("hidden");
      document.getElementById("policy").innerHTML = "";
      document.getElementById("thought").innerHTML = "";
      document.getElementById("script").innerHTML = "";
    }
  });

  document.querySelectorAll('.form-group').forEach(group => {
    const dateInput = group.querySelector('input[type="date"]');
    if (dateInput) {
      group.style.cursor = 'pointer'; 
      group.addEventListener('click', () => {

        if (dateInput.showPicker) {
          dateInput.showPicker();
        } else {
          dateInput.focus();
        }
      });
    }
  });

  function loadCountries(){
    const cfg=window.priceProtectConfig[lang];
    countrySel.innerHTML="";
    cfg.countries.forEach(c=>{
      const opt=document.createElement("option");
      opt.value=c; opt.textContent=c;
      countrySel.appendChild(opt);
    });
    loadChannels();

    specialCountrySel.innerHTML="";
    cfg.countries.forEach(c=>{
      const opt=document.createElement("option");
      opt.value=c; opt.textContent=c;
      specialCountrySel.appendChild(opt);
    });
    updateSpecialDisplay();
  }

  function loadChannels(){
    const cfg=window.priceProtectConfig[lang];
    const country=countrySel.value;
    const list=cfg.channels[country]||[];
    channelSel.innerHTML="";
    list.forEach(ch=>{
      const opt=document.createElement("option");
      opt.value=ch; opt.textContent=ch;
      channelSel.appendChild(opt);
    });
  }



function updateCopyButtonLink() {
    const cfg = window.priceProtectConfig[lang];
    const country = document.getElementById("country").value;
    const internalLink = cfg.links && cfg.links[country] ? cfg.links[country] : "https://docs.djicorp.com/weboffice/l/shYEp8S5foirW";
    document.getElementById("link-display").innerHTML = `
      <div style="background-color:#fffbea; border:1px solid #ffe58f; padding:8px 12px; border-radius:6px; font-family:Arial,'Microsoft YaHei'; font-size:0.85em; line-height:1.4; color:#664d03;">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <span style="font-weight:bold;display:flex;align-items:center;gap:6px;">${cfg.labels.linkTable}</span>
          <button id="copy-btn" style="padding:2px 6px;background-color:#1890ff;color:white;border:none;border-radius:3px;cursor:pointer;font-size:0.75em;display:inline-flex;align-items:center;gap:4px;width:auto;min-width:unset;">${cfg.labels.copyBtn}</button>
        </div>
        <div style="margin-top:4px;font-size:0.75em;color:#8c6d1f;">${cfg.labels.linkDesc}</div>
      </div>
    `;
    document.getElementById("copy-btn").addEventListener("click", function () {
      const btn = this;
      navigator.clipboard.writeText(internalLink).then(() => {
        btn.textContent = cfg.labels.copied;
        btn.style.backgroundColor = "#52c41a";
        setTimeout(() => {
          btn.textContent = cfg.labels.copyBtn;
          btn.style.backgroundColor = "#1890ff";
        }, 1000);
      }).catch(err => {
        console.error("复制失败:", err);
      });
    });
}


function updateLabels(){
    const cfg = window.priceProtectConfig[lang];
    document.getElementById("tab-main").textContent = cfg.tabs.main;
    document.getElementById("tab-special").textContent = cfg.tabs.special;
    document.getElementById("label-country").textContent = cfg.labels.country;
    document.getElementById("label-channel").textContent = cfg.labels.channel;
    document.getElementById("label-isActivityPeriod").textContent = cfg.labels.isActivityPeriod;
    document.getElementById("option-yes").textContent = cfg.labels.isActivityYes;
    document.getElementById("option-no").textContent = cfg.labels.isActivityNo;
    document.getElementById("label-deliver-date").textContent = cfg.labels.deliverDate;
    document.getElementById("label-apply-date").textContent = cfg.labels.applyDate;
    document.getElementById("label-special-country").textContent = cfg.labels.country;
    document.getElementById("calculate").textContent = cfg.labels.calcBtn;
    document.getElementById("result-title").textContent = cfg.labels.resultTitle;
}

function updateSpecialDisplay(){
  const cfg = window.priceProtectConfig[lang];
  const scCountry = specialCountrySel.value;
  const sc = cfg.specialCases[scCountry];

  if (!sc) {
    specialDisplay.innerHTML = "<p>暂无特殊场景说明</p>";
    return;
  }

  let html = `<h3 style="color:#007bff;">${sc.title}</h3>
              <p style="font-size:0.9em;color:#555;">${sc.content}</p>`;

  if (sc.cases && sc.cases.length > 0) {
    html += `<div style="margin-top:15px;">`;
    sc.cases.forEach(cs => {
      html += `<div style="
                  border:1px solid #ddd;
                  border-radius:6px;
                  padding:10px;
                  background:#f9f9f9;
                  margin-bottom:10px;">
                  <strong style="color:#333;">${cs.title}</strong>
                  <pre style="
                    white-space:pre-wrap;
                    word-break:break-word;
                    background:#fff;
                    padding:8px;
                    border-radius:4px;
                    margin-top:6px;
                    font-size:0.85em;
                  ">${cs.script}</pre>
               </div>`;
    });
    html += `</div>`;
  }

  specialDisplay.innerHTML = html;
}

function switchLanguage(newLang){
    lang = newLang;
    loadCountries();
    updateLabels();
    updateCopyButtonLink();
    resSection.classList.add("hidden");
// 英语模式显示二级Tab，中文模式隐藏
document.getElementById("en-subtabs").classList.toggle("hidden", lang !== "en");
}

btnZh.addEventListener("click",()=>{
    switchLanguage("zh");
    btnZh.style.background="#007bff";
    btnZh.style.color="#fff";
    btnEn.style.background="#fff";
    btnEn.style.color="#333";
});

btnEn.addEventListener("click",()=>{
    switchLanguage("en");
    btnEn.style.background="#007bff";
    btnEn.style.color="#fff";
    btnZh.style.background="#fff";
    btnZh.style.color="#333";
});

countrySel.addEventListener("change", () => {
    loadChannels();
    channelSel.value = "";
    deliverDate.value = "";
    applyDate.value = "";
    updateCopyButtonLink(); 
    resSection.classList.add("hidden");
});


  specialCountrySel.addEventListener("change",updateSpecialDisplay);

calcBtn.addEventListener("click",()=>{
  const isActivityPeriod = document.getElementById("isActivityPeriod").value;
  const cfg = window.priceProtectConfig[lang];
  const country = countrySel.value;
  const channel = channelSel.value;
  let phase = "";


  if (isActivityPeriod === "no") {
    phase = "afterActivity";
  } else {
    const deliver = new Date(deliverDate.value);
    const apply = new Date(applyDate.value);

    if (isNaN(deliver) || isNaN(apply)) {
      alert("请选择日期");
      return;
    }
    if (apply < deliver) {
      alert("申请价保时间不能早于客户签收时间！");
      return;
    }


    const diffDays = Math.floor((apply - deliver) / (1000*60*60*24));
    const thresholds = cfg.rules[country]?.thresholds || [7,30];
    const activityCfg = cfg.activity[country];
    if(activityCfg){
      const actEnd = new Date(activityCfg.end);
      if(apply > actEnd) phase = "afterActivity";
    }
    if(!phase){
      if(diffDays <= thresholds[0]) phase = "within7";
      else if(diffDays <= thresholds[1]) phase = "within30";
      else phase = "over30";
    }
  }

let policy;
if (country.includes("港") || country.includes("Hong Kong")) {
    policy = cfg.policies[channel]["hk_" + phase] || cfg.policies[channel][phase];
} else {
    policy = cfg.policies[channel][phase];
}

document.getElementById("policy").innerHTML = policy.policy || "";
document.getElementById("thought").innerHTML = policy.thought || "";
document.getElementById("script").innerHTML = policy.script || "";
  resSection.classList.remove("hidden");
});

document.querySelectorAll('.top-tab').forEach(tab=>{
    tab.addEventListener("click",()=>{
        // 切换样式
        document.querySelectorAll('.top-tab').forEach(t=>t.classList.remove("active"));
        tab.classList.add("active");

        if(tab.dataset.tab === "main"){ // Price Match
            mainContent.classList.remove("hidden");
            specialContent.classList.add("hidden");
            // 英文模式显示二级标签，中文隐藏
            document.getElementById("en-subtabs").classList.toggle("hidden", lang !== "en");
            // 默认显示 Other products 表单
            document.getElementById("other-products-form").classList.remove("hidden");
            document.getElementById("romo-form").classList.add("hidden");
        } else { // Special Cases
            mainContent.classList.add("hidden");
            specialContent.classList.remove("hidden");
            // Special Cases 隐藏二级标签
            document.getElementById("en-subtabs").classList.add("hidden");
        }
    });
});

switchLanguage(lang); // lang 默认是 "zh"
btnZh.style.background="#007bff";
btnZh.style.color="#fff";
});
</script>
</body>
</html>
